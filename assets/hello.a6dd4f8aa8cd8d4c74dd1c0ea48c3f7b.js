import*as O from"./atlab.0d725869d10fc8ebd7c2873a3d508fee.js";import{OrbitControls as I}from"./three/controls/OrbitControls.js";function D(r,n){return r+G()*n}function G(){let r=0;for(let n=0;n<12;n++)r=r+Math.random();return r-6}function L(r){if(typeof r!="string")return r;let{r:n=0,g=0,b:o=0,a:h=1}=r,s=r.match(/[.\d]+/g);return!s||s.length<3?{r:n,g,b:o,a:h}:(s.length==3&&s.push(1),[n=0,g=0,o=0,h=1]=s.map(l=>parseFloat(l)),{r:n,g,b:o,a:h})}function P(r,n={}){let{counts:g}=r.dataset,o=globalThis,[h=o.innerWidth,s=o.innerHeight-120]=[r.offsetWidth,r.offsetHeight],l=new THREE.PerspectiveCamera(70,h/s,1,100);l.position.z=25;let b=new THREE.Scene,f=0,m=0;if((!n||Object.keys(n).length===0)&&g&&(n=JSON.parse(g)),!n||Object.keys(n).length==0)f=5,m=1e3,Array.from({length:m},()=>D(Math.pow(2,f-1),6)).forEach(e=>{e=Math.round(e),!(e<0)&&(n[e]||(n[e]=0),n[e]++)});else{let e=0;m=0,Object.keys(n).forEach(t=>{let i=n[t];typeof t=="string"?(f<t.length&&(f=t.length),delete n[t],n[parseInt(t,2)]=i):t>e&&(e=t),m+=i}),e>0&&(f=Math.floor(Math.log2(e))+1)}let E=[],y=[],H=Math.pow(2,f),N=1/H;for(let e=0;e<H;e++)E.push({s:e,p:n[e]>0?n[e]/m:0}),y.push({s:e,p:N});let W=new THREE.MeshNormalMaterial({wireframe:!0}),c=new THREE.WebGLRenderer({antialias:!0,alpha:!0});c.setSize(h,s);let a=null,M=y.slice(0),d=-32,S=64;function j(){if(d<0||d>S){d<0&&d++;return}M=y.map((e,t)=>({s:e.s,p:e.p+((E[t]?E[t].p:0)-e.p)/S*d})),C(M),d++}function A(e){e.geometry&&(e.geometry.dispose(),e.geometry=void 0)}function $(e){let t=e.children;if(!(!t||t.length==0))for(let i=0;i<t.length;i++){let p=t[i];p instanceof THREE.Mesh?A(p):t[i].children&&t[i].children.length>0&&$(t[i])}}let u=o.getComputedStyle(r),[w,R,T]=[1,1447446,16777215];if(!u.backgroundColor)w=0;else{let{r:e=0,g:t=0,b:i=0,a:p=1}=L(u.backgroundColor);R=parseInt(`${`0${e.toString(16)}`.slice(-2)}${`0${t.toString(16)}`.slice(-2)}${`0${i.toString(16)}`.slice(-2)}`,16),w=p}if(u.color){let{r:e=0,g:t=0,b:i=0}=L(u.color);T=parseInt(`${`0${e.toString(16)}`.slice(-2)}${`0${t.toString(16)}`.slice(-2)}${`0${i.toString(16)}`.slice(-2)}`,16)}let C=(e,t,i)=>{a&&(b.remove(a),$(a)),z&&!t&&(t=z),a=O.view(f,{radius:i||8,states:e,material:W,xseg:60,yseg:60,faceOnly:!1,font:t,twist:!1}),a.add(new THREE.Mesh(new THREE.SphereGeometry(i||8,20,20),new THREE.MeshBasicMaterial({wireframe:!0,color:T,transparent:!0,opacity:.15}))),b.add(a)},x=new I(l,c.domElement);x.update(),c.setClearColor(R,w),r.appendChild(c.domElement);let z=null;C(M),c.setAnimationLoop(function(t){!a||(j(),a.rotation.z=t/2e3,a.rotation.y=t/1e3,x.update(),c.render(b,l))}),o.addEventListener("resize",function(){let[e=o.innerWidth,t=o.innerHeight-120]=[r.offsetWidth,r.offsetHeight];l.aspect=e/t,l.updateProjectionMatrix(),c.setSize(e,t)})}globalThis.ray=P;export{P as ray};
